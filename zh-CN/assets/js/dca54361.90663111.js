"use strict";(self.webpackChunkfeature_probe_docs=self.webpackChunkfeature_probe_docs||[]).push([[8463],{3905:(e,t,r)=>{r.d(t,{Zo:()=>d,kt:()=>c});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var i=n.createContext({}),u=function(e){var t=n.useContext(i),r=t;return e&&(r="function"==typeof e?e(t):p(p({},t),e)),r},d=function(e){var t=u(e.components);return n.createElement(i.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},s=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),s=u(r),c=a,k=s["".concat(i,".").concat(c)]||s[c]||m[c]||o;return r?n.createElement(k,p(p({ref:t},d),{},{components:r})):n.createElement(k,p({ref:t},d))}));function c(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,p=new Array(o);p[0]=s;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l.mdxType="string"==typeof e?e:a,p[1]=l;for(var u=2;u<o;u++)p[u]=r[u];return n.createElement.apply(null,p)}return n.createElement.apply(null,r)}s.displayName="MDXCreateElement"},8276:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>i,contentTitle:()=>p,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>u});var n=r(7462),a=(r(7294),r(3905));const o={sidebar_position:2},p="Docker image \u90e8\u7f72",l={unversionedId:"how-to/deploy/deployment-docker-image",id:"how-to/deploy/deployment-docker-image",title:"Docker image \u90e8\u7f72",description:"\u4f7f\u7528\u5404\u6a21\u5757\u63d0\u4f9b\u7684docker \u955c\u8c61\u5728 Linux/Unix/Mac \u72ec\u7acb\u90e8\u7f72\u5404\u5b50\u670d\u52a1",source:"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/how-to/deploy/deployment-docker-image.md",sourceDirName:"how-to/deploy",slug:"/how-to/deploy/deployment-docker-image",permalink:"/FeatureProbe/zh-CN/how-to/deploy/deployment-docker-image",draft:!1,editUrl:"https://github.com/FeatureProbe/FeatureProbe/blob/main/docs/i18n/zh-CN/docusaurus-plugin-content-docs/current/how-to/deploy/deployment-docker-image.md",tags:[],version:"current",lastUpdatedAt:1681286304,formattedLastUpdatedAt:"2023\u5e744\u670812\u65e5",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"defaultSidebar",previous:{title:"Docker Compose \u90e8\u7f72",permalink:"/FeatureProbe/zh-CN/how-to/deploy/deployment-docker-compose"},next:{title:"All In One \u90e8\u7f72",permalink:"/FeatureProbe/zh-CN/how-to/deploy/deployment-docker-all-in-one"}},i={},u=[{value:"\u73af\u5883\u51c6\u5907",id:"\u73af\u5883\u51c6\u5907",level:2},{value:"\u5b50\u670d\u52a1\u72ec\u7acb\u90e8\u7f72",id:"\u5b50\u670d\u52a1\u72ec\u7acb\u90e8\u7f72",level:2},{value:"\u64cd\u4f5c\u6b65\u9aa4",id:"\u64cd\u4f5c\u6b65\u9aa4",level:3},{value:"\u90e8\u7f72\u9a8c\u8bc1",id:"\u90e8\u7f72\u9a8c\u8bc1",level:2}],d={toc:u};function m(e){let{components:t,...r}=e;return(0,a.kt)("wrapper",(0,n.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"docker-image-\u90e8\u7f72"},"Docker image \u90e8\u7f72"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u4f7f\u7528\u5404\u6a21\u5757\u63d0\u4f9b\u7684docker \u955c\u8c61\u5728 Linux/Unix/Mac \u72ec\u7acb\u90e8\u7f72\u5404\u5b50\u670d\u52a1")),(0,a.kt)("h2",{id:"\u73af\u5883\u51c6\u5907"},"\u73af\u5883\u51c6\u5907"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Docker 17+"),(0,a.kt)("li",{parentName:"ul"},"MySQL 5.7+"),(0,a.kt)("li",{parentName:"ul"},"\u5efa\u8bae\uff1a\u751f\u4ea7\u73af\u58833\u4e2a\u8282\u70b9\u53ca\u4ee5\u4e0a"),(0,a.kt)("li",{parentName:"ul"},"\u5efa\u8bae\uff1a2\u6838 CPU/4G\u5185\u5b58\u53ca\u4ee5\u4e0a")),(0,a.kt)("h2",{id:"\u5b50\u670d\u52a1\u72ec\u7acb\u90e8\u7f72"},"\u5b50\u670d\u52a1\u72ec\u7acb\u90e8\u7f72"),(0,a.kt)("p",null,"\u4f7f\u7528\u5404\u6a21\u5757\u63d0\u4f9b\u7684 ",(0,a.kt)("a",{parentName:"p",href:"https://hub.docker.com/u/featureprobe"},"docker \u955c\u8c61"),"\u5728 Linux/Unix/Mac \u72ec\u7acb\u90e8\u7f72\u3002\n\u9700\u8981\u90e8\u7f72\u6709\u4e09\u4e2a\u670d\u52a1\u955c\u50cf\uff0c\u5982\u4e0b\u90e8\u7f72\u793a\u4f8b\uff1a"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"\u793a\u4f8b\u673a\u5668"),(0,a.kt)("th",{parentName:"tr",align:null},"\u90e8\u7f72\u6a21\u5757"),(0,a.kt)("th",{parentName:"tr",align:null},"\u7aef\u53e3"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"10.100.1.1"),(0,a.kt)("td",{parentName:"tr",align:null},"FeatureProbe API"),(0,a.kt)("td",{parentName:"tr",align:null},"4008")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"10.100.1.1"),(0,a.kt)("td",{parentName:"tr",align:null},"FeatureProbe UI"),(0,a.kt)("td",{parentName:"tr",align:null},"4009\uff08Nginx\uff09")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"10.100.1.2"),(0,a.kt)("td",{parentName:"tr",align:null},"FeatureProbe Server"),(0,a.kt)("td",{parentName:"tr",align:null},"4007 4011")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"10.100.1.3"),(0,a.kt)("td",{parentName:"tr",align:null},"\u6570\u636e\u5e93\uff08MySQL\uff09"),(0,a.kt)("td",{parentName:"tr",align:null},"13306")))),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"\u4e0a\u8ff0IP\u5730\u5740\u8bf7\u6839\u636e\u5b9e\u9645\u90e8\u7f72\u73af\u5883\u66ff\u6362\u4e3a\u5b9e\u9645IP\u5730\u5740\uff0c\u800c\u4e0d\u662f127.0.0.1\uff08Docker\u9ed8\u8ba4\u91c7\u7528bridge\u7f51\u7edc\u6a21\u5f0f\uff0c\u5e76\u4e0d\u6307\u5411\u5bbf\u4e3b\u673a\uff09")),(0,a.kt)("h3",{id:"\u64cd\u4f5c\u6b65\u9aa4"},"\u64cd\u4f5c\u6b65\u9aa4"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u8fd0\u884c MySQL \u6570\u636e\u5e93\u5b9e\u4f8b:"),(0,a.kt)("admonition",{parentName:"li",type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"\u5982\u679c\u4f7f\u7528\u60a8\u5df2\u7ecf\u90e8\u7f72\u597d\u7684\u5176\u4ed6MySQL\u73af\u5883\uff08\u53ef\u53c2\u8003",(0,a.kt)("a",{parentName:"p",href:"/reference/database-setup"},"\u521d\u59cb\u5316\u6570\u636e\u5e93"),"\u6587\u6863\uff09\uff0c\u53ef\u4ee5\u8df3\u8fc7\u6b64\u6b65\u9aa4\u3002\u5728\u4e0b\u4e00\u6b65API\u670d\u52a1\u7684\u542f\u52a8\u53c2\u6570\u4e2d\u586b\u5165\u60a8\u81ea\u5df1\u7684MySQL\u73af\u5883\u914d\u7f6e\u4fe1\u606f\u3002")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -p 13306:13306 \\\n    -e MYSQL_TCP_PORT=13306 \\\n    -e MYSQL_ROOT_PASSWORD=root \\\n    -e MYSQL_DATABASE=feature_probe \\\n    --name database -d mariadb\n")),(0,a.kt)("admonition",{parentName:"li",type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"\u66f4\u8be6\u7ec6\u6570\u636e\u5e93\u542f\u52a8\u53c2\u6570\u914d\u7f6e\u53ef\u4ee5\u53c2\u8003 ",(0,a.kt)("a",{parentName:"p",href:"https://mariadb.com/kb/en/mariadb-docker-environment-variables/"},"\u6570\u636e\u5e93\u914d\u7f6e"))))),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u8fd0\u884c FeatureProbe API \u5b9e\u4f8b:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -p 4008:4008 \\\n   -e server.port=4008 \\\n   -e spring.datasource.jdbc-url=jdbc:mysql://10.100.1.4:13306/feature_probe \\\n   -e spring.datasource.username=root \\\n   -e spring.datasource.password=root \\\n   -e app.analysis-url=http://10.100.1.1:4006\n   -e app.server-base-urls=http://10.100.1.1:4009\n   --name featureProbeAPI -d featureprobe/api\n   \n# \u4e0a\u8ff0 10.100.1.4:13306 \u4e3a MySQL Server \u7684 IP \u548c\u7aef\u53e3\uff0c\u8bf7\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\n# \u4e0a\u8ff0 10.100.1.1:4006 \u4e3aFeatureProbe Analysis \u7684IP\u548c\u7aef\u53e3\uff0c\u8bf7\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\n# \u4e0a\u8ff0 10.100.1.1:4009 \u4e3aFeatureProbe Server \u7684IP\u548c\u7aef\u53e3\uff0c\u8bf7\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\n")),(0,a.kt)("admonition",{parentName:"li",type:"info"},(0,a.kt)("p",{parentName:"admonition"},"API\u670d\u52a1\u66f4\u8be6\u7ec6\u7684\u542f\u52a8\u53c2\u6570\u8bf4\u660e\u89c1 ",(0,a.kt)("a",{parentName:"p",href:"../../reference/deployment-configuration#featureprobe-api"},"FeatureProbe API \u53c2\u6570\u8bf4\u660e\u6587\u6863")))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u8fd0\u884c FeatureProbe Server \u5b9e\u4f8b:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -p 4007:4007 -p 4011:4011 \\\n  -e FP_SERVER_PORT=4007 \\\n  -e FP_REALTIME_PORT=4011 \\\n  -e FP_TOGGLES_URL=http://10.100.1.1:4008/internal/server/toggles \\\n  -e FP_EVENTS_URL=http://10.100.1.1:4008/internal/server/events \\\n  -e FP_KEYS_URL=http://10.100.1.1:4008/internal/server/sdk_keys \\\n  -e FP_ANALYSIS_URL=http://10.100.1.1:4006/events \\\n  --name featureProbeServer -d featureprobe/server\n  \n# \u4e0a\u8ff0 10.100.1.1:4008 \u4e3a FeatureProbe API \u670d\u52a1 IP \u548c\u7aef\u53e3\uff0c\u8bf7\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\n# \u4e0a\u8ff0 10.100.1.1:4006 \u4e3a FeatureProbe Analysis \u670d\u52a1 IP \u548c\u7aef\u53e3\uff0c\u8bf7\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\n")),(0,a.kt)("admonition",{parentName:"li",type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Server\u670d\u52a1\u66f4\u8be6\u7ec6\u542f\u52a8\u53c2\u6570\u8bf4\u660e\u8be6\u89c1 ",(0,a.kt)("a",{parentName:"p",href:"../../reference/deployment-configuration#featureprobe-server"},"FeatureProbe Server \u53c2\u6570\u8bf4\u660e\u6587\u6863")))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u8fd0\u884c FeatureProbe Analysis \u5b9e\u4f8b\uff1a"))),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Analysis\u670d\u52a1\u6570\u636e\u5e93\u4e0eAPI\u6570\u636e\u5e93\u662f\u5206\u5f00\u7684\uff0c\u8fd0\u884cAnalysis\u4e4b\u524d\uff0c\u8bf7\u5148\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a feature_probe_events \u7684\u5e93, \u53ef\u4ee5\u4f7f\u7528\u4e0a\u9762\u540c\u4e00\u4e2a\u6570\u636e\u5e93\u670d\u52a1\u3002")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"CREATE DATABASE IF NOT EXISTS feature_probe_events;\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -p 4006:4006 \\\n       -e server.port=4006 \\\n       -e app.datasource.jdbcUrl=jdbc:mysql://10.100.1.4:13306/feature_probe_events \\\n       -e app.datasource.username=root \\\n       -e app.datasource.password=fp@root \\\n       -e spring.profiles.active=online \\\n       -e JVM_ARGS='-Xmx2048m -Xms2048m' \\\n       -e TZ=Asia/Shanghai \\\n       --name featureProbeAnalysis -d featureprobe/analysis\n  \n# \u4e0a\u8ff0 10.100.1.4:13306 \u4e3a MySQL Server \u7684 IP \u548c\u7aef\u53e3\uff0c\u8bf7\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\n")),(0,a.kt)("ol",{start:5},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u8fd0\u884c FeatureProbe UI \u5b9e\u4f8b:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -p 4009:4009 \\\n-v /my_custom/default.conf:/etc/nginx/conf.d/default.conf \\\n--name featureProbeUI -d featureprobe/ui \n")),(0,a.kt)("p",{parentName:"li"},"\u4e3a\u4fdd\u8bc1 API \u548c UI \u7aef\u53e3\u4e00\u81f4(\u907f\u514d\u8bf7\u6c42\u8de8\u57df)\uff0c\u9700\u8981\u81ea\u5b9a\u4e49 nginx \u914d\u7f6e\u8f6c\u53d1 API \u8bf7\u6c42\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"/my_custom/default.conf")," \u914d\u7f6e\u5982\u4e0b\u793a\u4f8b\uff1a"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-nginx"},"upstream featureProbeAPI {\n   # FeatureProbeAPI \u670d\u52a1\u7684 IP \u548c\u7aef\u53e3\uff0c\u8bf7\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\n   server 10.100.1.1:4008;\n}\n\nserver {\n   # \u8bbf\u95ee\u7684 UI \u7aef\u53e3\n   listen 4009;  # UI \u7aef\u53e3\n\n   location / {\n      index  index.html index.htm;\n      root /usr/share/nginx/html;\n      try_files $uri /index.html;\n   }\n\n   location /api { # \u8bbf\u95ee /api \u65f6\u7edf\u4e00\u8f6c\u53d1\u5230 featureProbeAPI \u670d\u52a1\n      proxy_set_header X-Real-IP $remote_addr;\n      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n      proxy_set_header X-NginX-Proxy true;\n      proxy_pass http://featureProbeAPI/api;\n      proxy_ssl_session_reuse off;\n      proxy_set_header Host $http_host;\n      proxy_cache_bypass $http_upgrade;\n      proxy_redirect off;\n   }\n}\n")))),(0,a.kt)("h2",{id:"\u90e8\u7f72\u9a8c\u8bc1"},"\u90e8\u7f72\u9a8c\u8bc1"),(0,a.kt)("p",null,"\u4e0a\u8ff0\u670d\u52a1\u542f\u52a8\u540e\u6253\u5f00\u6d4f\u89c8\u5668\uff0c\u8bbf\u95ee\uff1a",(0,a.kt)("inlineCode",{parentName:"p"},"http://10.100.1.2:4009")," (UI\u670d\u52a1 IP \u548c\u7aef\u53e3)\u5e76\u7528\u4ee5\u4e0b\u9ed8\u8ba4\u5e10\u53f7\u767b\u5f55\u8bd5\u7528\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"username: ",(0,a.kt)("inlineCode",{parentName:"li"},"admin")),(0,a.kt)("li",{parentName:"ul"},"password: ",(0,a.kt)("inlineCode",{parentName:"li"},"Pass1234"))))}m.isMDXComponent=!0}}]);