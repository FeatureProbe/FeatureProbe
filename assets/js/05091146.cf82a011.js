"use strict";(self.webpackChunkfeature_probe_docs=self.webpackChunkfeature_probe_docs||[]).push([[2540],{3905:(e,t,r)=>{r.d(t,{Zo:()=>s,kt:()=>c});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},l=Object.keys(e);for(a=0;a<l.length;a++)r=l[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var p=a.createContext({}),d=function(e){var t=a.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},s=function(e){var t=d(e.components);return a.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,l=e.originalType,p=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),m=d(r),c=n,k=m["".concat(p,".").concat(c)]||m[c]||u[c]||l;return r?a.createElement(k,o(o({ref:t},s),{},{components:r})):a.createElement(k,o({ref:t},s))}));function c(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=r.length,o=new Array(l);o[0]=m;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:n,o[1]=i;for(var d=2;d<l;d++)o[d]=r[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,r)}m.displayName="MDXCreateElement"},9709:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>d});var a=r(7462),n=(r(7294),r(3905));const l={sidebar_position:3},o="All In One Deploy Guide",i={unversionedId:"how-to/deploy/deployment-docker-all-in-one",id:"how-to/deploy/deployment-docker-all-in-one",title:"All In One Deploy Guide",description:"This document describes how to deploy the FeatureProbe service using an All-In-One deployment method, where all services are contained within a single container.",source:"@site/docs/how-to/deploy/deployment-docker-all-in-one.md",sourceDirName:"how-to/deploy",slug:"/how-to/deploy/deployment-docker-all-in-one",permalink:"/FeatureProbe/how-to/deploy/deployment-docker-all-in-one",draft:!1,editUrl:"https://github.com/FeatureProbe/FeatureProbe/blob/main/docs/docs/how-to/deploy/deployment-docker-all-in-one.md",tags:[],version:"current",lastUpdatedAt:1679371811,formattedLastUpdatedAt:"Mar 21, 2023",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"defaultSidebar",previous:{title:"Docker Deploy Guide",permalink:"/FeatureProbe/how-to/deploy/deployment-docker-image"},next:{title:"Source Code Deploy Guide",permalink:"/FeatureProbe/how-to/deploy/deployment-source-code"}},p={},d=[{value:"Environment Preparation",id:"environment-preparation",level:2},{value:"Deploy",id:"deploy",level:2}],s={toc:d};function u(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},s,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"all-in-one-deploy-guide"},"All In One Deploy Guide"),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"This document describes how to deploy the FeatureProbe service using an All-In-One deployment method, where all services are contained within a single container.")),(0,n.kt)("h2",{id:"environment-preparation"},"Environment Preparation"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Docker 17+"),(0,n.kt)("li",{parentName:"ul"},"Mysql 5.7+"),(0,n.kt)("li",{parentName:"ul"},"Recommendation: 2-core CPU/4G memory and above")),(0,n.kt)("h2",{id:"deploy"},"Deploy"),(0,n.kt)("p",null,"Running with Docker on Linux/Unix/Mac"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Setps:")),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Creating FeatureProbe Database"),(0,n.kt)("p",{parentName:"li"},"Before deploying the All-In-One FeatureProbe service, you need to create the required database in the prepared database service."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"CREATE DATABASE IF NOT EXISTS feature_probe;\nCREATE DATABASE IF NOT EXISTS feature_probe_events;\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Starting FeatureProbe Container"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"docker run  -p 4008:4008 -p  4006:4006 -p 4007:4007 -p 4011:4011 \\\n-e api_server_port=4008 \\\n-e api_spring_profiles_active=online \\\n-e API_JVM_ARGS='-Xmx2048m -Xms2048m' \\\n-e spring.datasource.jdbc-url=jdbc:mysql://172.24.141.155:13306/feature_probe \\\n-e spring.datasource.username=root \\\n-e spring.datasource.password=root \\\n-e app.server-base-urls=http://127.0.0.1:4007 \\\n-e app.analysis-base-url=http://127.0.0.1:4006 \\\n-e analysis_server_port=4006 \\\n-e app.datasource.jdbcUrl=jdbc:mysql://172.24.141.155:13306/feature_probe_events \\\n-e app.datasource.username=root \\\n-e app.datasource.password=root \\\n-e analysis_spring_profiles_active=online \\\n-e ANALYSIS_JVM_ARGS='-Xmx2048m -Xms2048m' \\\n-e RUST_LOG=info \\\n-e FP_SERVER_PORT=4007 \\\n-e FP_TOGGLES_URL=http://127.0.0.1:4008/internal/server/toggles \\\n-e FP_EVENTS_URL=http://127.0.1.0:4008/internal/server/events \\\n-e FP_KEYS_URL=http://127.0.0.1:4008/internal/server/sdk_keys \\\n-e FP_ANALYSIS_URL=http://127.0.0.1:4006/events \\\n-e FP_REFRESH_SECONDS=10 \\\n-e FP_REALTIME_PORT=4011 \\\n-e TZ=Asia/Shanghai \\\n--name featureProbeAll -d featureprobe/featureprobe \n")))),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},(0,n.kt)("em",{parentName:"strong"},"Service Configuration Details")))),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"Configuration"),(0,n.kt)("th",{parentName:"tr",align:null},"Module"),(0,n.kt)("th",{parentName:"tr",align:null},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"api_server_port"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe API"),(0,n.kt)("td",{parentName:"tr",align:null},"The port on which the API server will be started")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"api_spring_profiles_active"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe API"),(0,n.kt)("td",{parentName:"tr",align:null},"The active profile(s) to be loaded after the configuration file is read")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"API_JVM_ARGS"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe API"),(0,n.kt)("td",{parentName:"tr",align:null},"JVM arguments for the API server")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"spring.datasource.jdbc-url"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe API"),(0,n.kt)("td",{parentName:"tr",align:null},"The URL of the database to be used by the API server")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"spring.datasource.username"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe API"),(0,n.kt)("td",{parentName:"tr",align:null},"The username to be used to connect to the database for the API server")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"spring.datasource.password"),(0,n.kt)("td",{parentName:"tr",align:null}),(0,n.kt)("td",{parentName:"tr",align:null})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"spring.datasource.password"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe API"),(0,n.kt)("td",{parentName:"tr",align:null},"The password to be used to connect to the database for the API server")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"app.server-base-urls"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe API"),(0,n.kt)("td",{parentName:"tr",align:null},"The address(es) of the server(s) on which the API will be deployed. Multiple addresses can be separated by commas. (For multi-instance deployment, it is recommended to configure the gateway address)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"app.analysis-base-url"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe API"),(0,n.kt)("td",{parentName:"tr",align:null},"The address of the analysis service, currently only supports a single address. (For multi-instance deployment, it is recommended to configure the gateway address)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null}),(0,n.kt)("td",{parentName:"tr",align:null}),(0,n.kt)("td",{parentName:"tr",align:null})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"analysis_server_port"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe Analysis"),(0,n.kt)("td",{parentName:"tr",align:null},"The port on which the analysis server will be started")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"app.datasource.jdbcUrl"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe Analysis"),(0,n.kt)("td",{parentName:"tr",align:null},"The URL of the database to be used by the analysis server")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"app.datasource.username"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe Analysis"),(0,n.kt)("td",{parentName:"tr",align:null},"The username to be used to connect to the database for the analysis server")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"app.datasource.password"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe Analysis"),(0,n.kt)("td",{parentName:"tr",align:null},"The password to be used to connect to the database for the analysis server")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"analysis_spring_profiles_active"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe Analysis"),(0,n.kt)("td",{parentName:"tr",align:null},"The active profile(s) to be loaded after the configuration file is read")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"ANALYSIS_JVM_ARGS"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe Analysis"),(0,n.kt)("td",{parentName:"tr",align:null},"JVM arguments for the analysis server")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null}),(0,n.kt)("td",{parentName:"tr",align:null}),(0,n.kt)("td",{parentName:"tr",align:null})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"RUST_LOG"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe Server"),(0,n.kt)("td",{parentName:"tr",align:null},"Log level")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"FP_SERVER_PORT"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe Server"),(0,n.kt)("td",{parentName:"tr",align:null},"The port on which the Server will be started")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"FP_TOGGLES_URL"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe Server"),(0,n.kt)("td",{parentName:"tr",align:null},"toggle configuration acquisition url (API)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"FP_EVENTS_URL"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe Server"),(0,n.kt)("td",{parentName:"tr",align:null},"Event reporting url (API)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"FP_KEYS_URL"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe Server"),(0,n.kt)("td",{parentName:"tr",align:null},"Key acquisition url (API)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"FP_ANALYSIS_URL"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe Server"),(0,n.kt)("td",{parentName:"tr",align:null},"Metric events reporting url (Analysis)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"FP_REFRESH_SECONDS"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe Server"),(0,n.kt)("td",{parentName:"tr",align:null},"toggle refresh time")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"FP_REALTIME_PORT"),(0,n.kt)("td",{parentName:"tr",align:null},"FeatureProbe Server"),(0,n.kt)("td",{parentName:"tr",align:null},"Long connection server port")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"TZ"),(0,n.kt)("td",{parentName:"tr",align:null},"All"),(0,n.kt)("td",{parentName:"tr",align:null},"Container time zone")))),(0,n.kt)("ol",{start:3},(0,n.kt)("li",{parentName:"ol"},"Go to UI/Portal at ",(0,n.kt)("inlineCode",{parentName:"li"},"http://localhost:4008")," and use the default credentials to log in.",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"username: ",(0,n.kt)("inlineCode",{parentName:"li"},"admin")),(0,n.kt)("li",{parentName:"ul"},"password: ",(0,n.kt)("inlineCode",{parentName:"li"},"Pass1234"))))))}u.isMDXComponent=!0}}]);